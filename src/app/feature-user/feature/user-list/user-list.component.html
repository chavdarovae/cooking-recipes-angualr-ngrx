@if (data$ | async; as data) {
    <div class="container">
        <form class="form form--filter">
            <i class="fa-solid fa-magnifying-glass"></i>

            <clt-input-field
                modelName="searchString"
                inpType="text"
                placeholder="Username or Email"
                [isTypeAhead]="true"
                [inpValue]="query.search ?? ''"
                (onInpChanged)="query.search = $event; onSearchQueryChange()">
            </clt-input-field>

            <clt-input-select
                modelName="role"
                placeholder="All roles"
                [selectList]="userRolesEnum"
                [inpValue]="query.role"
                [selectEcceptions]="[userRolesEnum.GUEST]"
                (onSelectChanged)="query.role = $event; onSearchQueryChange()">
            </clt-input-select>
        </form>

        <div class="card-container">
            <div
                class="card-container__button accent"
                [routerLink]="['/users/create']"
                routerLinkActive="router-link-active">
                +
            </div>
            @for (account of data.userList; track account._id) {
                <article class="account jumpy-card row row--no-wrap gap-20">
                    <i class="fa-solid fa-user"></i>

                    <div class="account__body col col--no-wrap gap-10">
                        <span>Username:</span> <span class="text-accent">{{ account.username }}</span> <span>Email:</span>
                        <a
                            class="text-accent"
                            [href]="'mailto:' + account.email">
                            {{ account.email }}
                        </a>
                        <span>Role:</span> <span class="text-accent">{{ account.role }}</span>
                        <div class="row row--no-wrap span-2 gap-10">
                            <button
                                class="danger span-2 w100 mt-10"
                                (click)="showDeleteUserDialog(account)">
                                Delete
                            </button>

                            <button
                                class="accent span-2 w100 mt-10"
                                [routerLink]="['/users', account?._id, 'edit']"
                                routerLinkActive="router-link-active">
                                Edit
                            </button>
                        </div>
                    </div>
                </article>
            } @empty {
                <h5 class="row row--centered row--middle">No results found!</h5>
            }
        </div>
    </div>
}

<app-modal
    [show]="showModal"
    entity="user"
    (close)="onModalClosed($event)">
</app-modal>
