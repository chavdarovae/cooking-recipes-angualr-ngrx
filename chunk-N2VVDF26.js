import{a as Me,b as Y,c as Fe,d as Te,e as J,g as Oe,h as De}from"./chunk-GFVM6BWV.js";import{a as Q,l as ke,p as Ve,v as x,w as v,x as S}from"./chunk-CKRMVRVY.js";import{$a as O,$b as Le,Aa as p,Ab as W,Ba as y,Db as Se,Eb as pe,H as me,Ia as V,J as b,Ja as C,Kb as be,L as w,La as f,Nb as _,Ob as we,P as ue,Pb as Ee,Ra as ge,T as c,Ua as R,Va as B,Wa as _e,X as h,Xa as U,Y as I,Ya as he,Za as Ie,_a as j,_b as N,a as l,ab as D,b as d,c as $e,cc as m,dc as Be,e as ce,ea as G,fa as s,fc as Ae,hb as Ce,k as M,la as k,n as F,o as P,ob as $,pb as ye,rb as xe,t as de,ta as E,tb as ve,u as T,ua as L,wa as fe,xa as Re,ya as u,za as a,zb as K}from"./chunk-N7MNUTHW.js";var n=we({source:"recipeActions",events:{getAllRecipes:_(),getAllRecipesSuccess:_(),getAllRecipesFailure:_(),getRecipeById:_(),getRecipeByIdSuccess:_(),getRecipeByIdFailure:_(),createRecipe:_(),createRecipeSuccess:_(),createRecipeFailure:_(),deleteRecipeById:_(),deleteRecipeByIdSuccess:Ee(),deleteRecipeByIdFailure:_(),updateRecipeById:_(),updateRecipeByIdSuccess:_(),updateRecipeByIdFailure:_(),recommendRecipeById:_(),recommendRecipeByIdSuccess:_(),recommendRecipeByIdFailure:_()}});var Pe={isLoading:!1,validatonErrors:null,recipeList:null,recipe:null},Ne=Le({name:"recipe",reducer:Be(Pe,m(n.getAllRecipes,t=>d(l({},t),{isLoading:!0})),m(n.getAllRecipesSuccess,(t,e)=>d(l({},t),{isLoading:!1,recipeList:e.recipeList})),m(n.getAllRecipesFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(n.getRecipeById,t=>d(l({},t),{isLoading:!0})),m(n.getRecipeByIdSuccess,(t,e)=>d(l({},t),{isLoading:!1,recipe:e.recipe})),m(n.getRecipeByIdFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(n.createRecipe,t=>d(l({},t),{isLoading:!0})),m(n.createRecipeSuccess,(t,e)=>d(l({},t),{isLoading:!1,recipe:e.recipe})),m(n.createRecipeFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(n.deleteRecipeById,t=>d(l({},t),{isLoading:!0})),m(n.deleteRecipeByIdSuccess,t=>d(l({},t),{isLoading:!1,recipe:null})),m(n.deleteRecipeByIdFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(n.updateRecipeById,t=>d(l({},t),{isLoading:!0})),m(n.updateRecipeByIdSuccess,(t,e)=>d(l({},t),{isLoading:!1,recipe:e.recipe})),m(n.updateRecipeByIdFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(n.recommendRecipeById,t=>d(l({},t),{isLoading:!0})),m(n.recommendRecipeByIdSuccess,(t,e)=>d(l({},t),{isLoading:!1,recipe:e.recipe})),m(n.recommendRecipeByIdFailure,(t,e)=>d(l({},t),{isLoading:!1,validatonErrors:e.errors})),m(Ae,(t,e)=>{let r=e.payload.routerState.url.endsWith("/edit");return d(l({},Pe),{recipe:r?t.recipe:null})}))}),{name:_t,reducer:ht,selectIsLoading:q,selectRecipeList:Ue,selectRecipe:X,selectValidatonErrors:Z}=Ne;var qe=t=>["/recipes",t],ee=class t{recipe=Ce();static \u0275fac=function(i){return new(i||t)};static \u0275cmp=k({type:t,selectors:[["rcp-card"]],inputs:{recipe:[1,"recipe"]},decls:9,vars:9,consts:[[1,"card","jumpy-card"],[3,"src","alt"],["routerLinkActive","router-link-active",1,"accent","mt-10",3,"routerLink"]],template:function(i,r){if(i&1&&(a(0,"article",0)(1,"div"),y(2,"img",1),p(),a(3,"h4"),R(4),p(),a(5,"p"),R(6),p(),a(7,"button",2),R(8," Read More "),p()()),i&2){let o,g,z,se,le;s(2),u("src",U((o=r.recipe())==null?null:o.image),G)("alt",U((g=r.recipe())==null?null:g.title)),s(2),B((z=r.recipe())==null?null:z.title),s(2),B((se=r.recipe())==null?null:se.description),s(),u("routerLink",j(7,qe,(le=r.recipe())==null?null:le._id))}},dependencies:[W],styles:[".card[_ngcontent-%COMP%]{width:100%;padding:15px;text-align:center;overflow:hidden;display:flex;flex-flow:column nowrap;align-items:center}.card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-radius:8px;margin-bottom:1em;transition:transform .3s}.card[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05)}.card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{width:100%;height:80px;background-color:#2c3e50;color:#f5f5f5;border-radius:4px;padding:10px}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#2c3e50;height:60px;overflow:hidden;text-overflow:ellipsis}"],changeDetection:0})};var ie=class{title;ingredients;instructions;description;image;owner;constructor(e="",i="",r="",o="",g="",z=""){this.title=e,this.ingredients=i,this.instructions=r,this.description=o,this.image=g,this.owner=z}},re=class{search;owner;constructor(e,i){this.search=e,this.owner=i}};var je=(t,e)=>e._id;function Qe(t,e){if(t&1&&y(0,"rcp-card",5),t&2){let i=e.$implicit;u("recipe",i)}}function He(t,e){if(t&1){let i=V();a(0,"div",0)(1,"form",1),y(2,"i",2),a(3,"clt-input-field",3),C("onInpChanged",function(o){h(i);let g=f();return I(g.onSearchStringChange(o))}),p()(),a(4,"div",4),fe(5,Qe,1,1,"rcp-card",5,je),p()()}if(t&2){let i=f();s(3),u("isTypeAhead",!0)("inpValue",i.query.search??""),s(2),Re(e.recipeList)}}var ne=class t{store=c(N);data$=P({isLoading:this.store.select(q),recipeList:this.store.select(Ue),backendErrors:this.store.select(Z)});query;ngOnInit(){this.query=new re(""),this.store.dispatch(n.getAllRecipes({query:this.query}))}onSearchStringChange(e){let i=d(l({},this.query),{search:e});this.store.dispatch(n.getAllRecipes({query:i}))}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=k({type:t,selectors:[["app-recipe-list"]],features:[he([Y])],decls:2,vars:3,consts:[[1,"container"],[1,"form","form--filter"],[1,"fa-solid","fa-magnifying-glass"],["modelName","searchString","inpType","text","placeholder","Recipe title",3,"onInpChanged","isTypeAhead","inpValue"],[1,"card-container"],[3,"recipe"]],template:function(i,r){if(i&1&&(E(0,He,7,2,"div",0),O(1,"async")),i&2){let o;L((o=D(1,1,r.data$))?0:-1,o)}},dependencies:[ee,J,$],encapsulation:2})};var ze=t=>[t],Ge=t=>({recipe:t}),Ke=()=>["/recipes/"];function We(t,e){if(t&1){let i=V();a(0,"button",9),C("click",function(){h(i);let o=f(3);return I(o.modifyEntity("deleteDialog"))}),R(1," Delete "),p(),a(2,"button",10),R(3," Edit "),p()}if(t&2){let i=f();s(2),u("routerLink",j(2,ze,"/recipes/"+(i==null?null:i._id)+"/edit"))("state",j(4,Ge,i))}}function Ye(t,e){if(t&1){let i=V();a(0,"button",11),R(1,"Back to Recipes"),p(),a(2,"button",12),C("click",function(){h(i);let o=f(3);return I(o.modifyEntity("recommend"))}),R(3," Recommend "),p()}if(t&2){let i=f(3);u("routerLink",Ie(2,Ke)),s(2),u("disabled",i.isRecommendedByCurrUser)}}function Je(t,e){t&1&&(a(0,"div"),R(1,"You've already recommended this recipe!"),p())}function Xe(t,e){if(t&1){let i=V();a(0,"article",1)(1,"h2"),R(2),p(),a(3,"div",2)(4,"div",3)(5,"span"),R(6),p(),y(7,"i",4),p(),y(8,"img",5),p(),a(9,"div",6)(10,"p"),R(11),p(),y(12,"hr"),a(13,"h3"),R(14,"Ingredients:"),p(),a(15,"p"),R(16),p(),y(17,"hr"),a(18,"h3"),R(19,"Instructions:"),p(),a(20,"p"),R(21),p(),y(22,"hr"),a(23,"div",7),E(24,We,4,6)(25,Ye,4,3),p()()(),E(26,Je,2,0,"div"),a(27,"app-modal",8),C("close",function(o){h(i);let g=f(2);return I(g.onModalClosed(o))}),p()}if(t&2){let i=e,r=f(),o=f();s(2),B(i==null?null:i.title),s(4),B(i==null||i.recommendList==null?null:i.recommendList.length),s(2),u("src",U(i==null?null:i.image),G)("alt",U(i==null?null:i.title)),s(3),B(i==null?null:i.description),s(5),B(i==null?null:i.ingredients),s(5),B(i==null?null:i.instructions),s(3),L((r==null||r.currUser==null?null:r.currUser._id)===(i==null?null:i.owner)?24:25),s(2),L(-1),s(),u("show",o.showModal)}}function Ze(t,e){if(t&1&&(a(0,"div",0),E(1,Xe,28,12),p()),t&2){let i,r=e;s(),L((i=r==null?null:r.recipe)?1:-1,i)}}var oe=class t{store=c(N);id;currRecipe;data$=P({isLoading:this.store.select(q),recipe:this.store.select(X),backendErrors:this.store.select(Z),currUser:this.store.select(ke)}).pipe(w(e=>{this.currRecipe=e.recipe,this.isRecommendedByCurrUser=!!e.recipe?.recommendList?.some(i=>i._id===e.currUser?._id)}));showModal=!1;isRecommendedByCurrUser;ngOnInit(){this.store.dispatch(n.getRecipeById({recipeId:this.id}))}onModalClosed(e){e&&this.modifyEntity("delete"),this.showModal=!1}modifyEntity(e){if(this.currRecipe?._id)switch(e){case"deleteDialog":this.showModal=!0;break;case"delete":this.store.dispatch(n.deleteRecipeById({recipeId:this.currRecipe._id}));break;case"recommend":this.store.dispatch(n.recommendRecipeById({recipeId:this.currRecipe._id}));break}}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=k({type:t,selectors:[["app-recipe-detail"]],inputs:{id:"id"},decls:2,vars:3,consts:[[1,"container"],[1,"recipe"],[1,"recipe__block"],[1,"likes"],[1,"fa-solid","fa-heart"],[3,"src","alt"],[1,"recipe__block","col","col--space-btw"],[1,"row","row--no-wrap","row--space-btw","w100","mt-20"],["entity","recipe",3,"close","show"],[1,"danger",3,"click"],[3,"routerLink","state"],[3,"routerLink"],[1,"accent",3,"click","disabled"]],template:function(i,r){if(i&1&&(E(0,Ze,2,1,"div",0),O(1,"async")),i&2){let o;L((o=D(1,1,r.data$))?0:-1,o)}},dependencies:[W,De,$],styles:[".recipe[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:2rem;width:min(1000px,100%);height:fit-content;background:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:2rem;margin:auto;transition:transform .3s,box-shadow .3s}.recipe__block[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;overflow:hidden;position:relative}@media (min-width: 961px){.recipe__block[_ngcontent-%COMP%]{width:calc(500px - 3rem)}}.recipe[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:100%;background-color:#2c3e50;color:#f5f5f5;padding:.5em;border-radius:8px;text-align:center;margin-bottom:0}.likes[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}.likes[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc143c;font-size:50px}.likes[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;color:#f5f5f5;font-size:20px;font-weight:600;top:50%;left:50%;transform:translate(-50%,-60%)}"]})};function et(t,e){if(t&1){let i=V();a(0,"div",1)(1,"form",2,0)(3,"clt-input-field",3),C("onInpChanged",function(o){h(i);let g=f();return I(g.currRecipe.title=o)}),p(),a(4,"clt-input-textarea",4),C("onInpChanged",function(o){h(i);let g=f();return I(g.currRecipe.description=o)}),p(),a(5,"clt-input-textarea",5),C("onInpChanged",function(o){h(i);let g=f();return I(g.currRecipe.ingredients=o)}),p(),a(6,"clt-input-field",6),C("onInpChanged",function(o){h(i);let g=f();return I(g.currRecipe.instructions=o)}),p(),a(7,"clt-input-field",7),C("onInpChanged",function(o){h(i);let g=f();return I(g.currRecipe.image=o)}),p(),a(8,"div")(9,"button",8),C("click",function(){h(i);let o=f();return I(o.onSubmit(o.allowedAction))}),R(10),O(11,"titlecase"),p()()()()}if(t&2){let i=ge(2),r=f();s(3),u("minLength",2)("isRequired",!0)("inpValue",r.currRecipe.title),s(),u("minLength",10)("maxLength",100)("isRequired",!0)("inpValue",r.currRecipe.description),s(),u("minLength",10)("maxLength",400)("isRequired",!0)("inpValue",r.currRecipe.ingredients),s(),u("minLength",10)("isRequired",!0)("inpValue",r.currRecipe.instructions),s(),u("minLength",6)("isRequired",!0)("inpValue",r.currRecipe.image),s(2),u("disabled",i.invalid),s(),_e(" ",D(11,19,r.allowedAction)," Recipe ")}}var H=class t{store=c(N);currRecipe;allowedAction;data$=P({isLoading:this.store.select(q),recipe:this.store.select(X)}).pipe(w(e=>{this.currRecipe=e.recipe?l({},e.recipe):new ie,this.allowedAction=this.currRecipe?._id?"update":"create"}));onSubmit(e){let i=l({},this.currRecipe);switch(e){case"update":this.store.dispatch(n.updateRecipeById({recipe:i}));break;case"create":this.store.dispatch(n.createRecipe({recipe:i}));break}}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=k({type:t,selectors:[["app-recipe-create"]],decls:2,vars:3,consts:[["createForm","ngForm"],[1,"container"],[1,"form","w80","pt-30","pb-30","pl-50","pr-50"],["label","Recipe Title","modelName","recipeTitle","inpType","text",3,"onInpChanged","minLength","isRequired","inpValue"],["label","Description","modelName","description",3,"onInpChanged","minLength","maxLength","isRequired","inpValue"],["label","Ingredients","modelName","ingredients",3,"onInpChanged","minLength","maxLength","isRequired","inpValue"],["label","Instructions","modelName","instructions","inpType","text",3,"onInpChanged","minLength","isRequired","inpValue"],["label","Image URL","modelName","image","inpType","text",3,"onInpChanged","minLength","isRequired","inpValue"],["type","submit",1,"accent",3,"click","disabled"]],template:function(i,r){if(i&1&&(E(0,et,12,21,"div",1),O(1,"async")),i&2){let o;L((o=D(1,1,r.data$))?0:-1,o)}},dependencies:[xe,Te,Fe,Me,Y,Se,J,Oe,$,ye],encapsulation:2})};var Ii=[{path:"",component:ne},{path:"create",component:H},{path:":id",component:oe},{path:":id/edit",component:H}];var dt={};$e(dt,{createRecipeEffect:()=>ot,deleteRecipeByIdEffect:()=>rt,getAllRecipesEffect:()=>tt,getRecipeByIdEffect:()=>it,recommendRecipeByIdEffect:()=>st,redirectAndAlertEffectAfterCreatedRecipeSuccess:()=>ct,redirectAndAlertEffectAfterDeleteRecipeByIdSuccess:()=>nt,redirectAndAlertEffectAfterUpdateRecipeByIdSuccess:()=>at,showAlertEffectRecommendRecipeByIdSuccess:()=>lt,updateRecipeByIdEffect:()=>pt});var A=class t{http=c(ve);utilService=c(be);accountApi=Ve.backendUrl+"/api/recipes";relaodRecipesSubj=new ce;recipes$=this.relaodRecipesSubj.asObservable().pipe(b(e=>{let i=this.utilService.transformQueryIntoParams(e);return this.http.get(this.accountApi,{params:i})}),me());recipesSig=pe(this.recipes$,{initialValue:[]});selectedRecipeSubj=new ce;selectedRecipe$=this.selectedRecipeSubj.asObservable().pipe(de(e=>!!e),b(e=>this.http.get(`${this.accountApi}/${e}`)));selectedRecipeSig=pe(this.selectedRecipe$,{initialValue:null});reloadRecipes(e){this.relaodRecipesSubj.next(e)}selectRecipe(e){this.selectedRecipeSubj.next(e)}getAllRecipes(e){let i=this.utilService.transformQueryIntoParams(e);return this.http.get(this.accountApi,{params:i})}getRecipeById(e){return this.http.get(`${this.accountApi}/${e}`)}create(e){return this.http.post(this.accountApi,e)}update(e){return this.http.put(`${this.accountApi}/${e._id}`,e)}recommend(e){return this.http.get(`${this.accountApi}/${e}/recommend`)}delete(e){return this.http.delete(`${this.accountApi}/${e}`)}static \u0275fac=function(i){return new(i||t)};static \u0275prov=ue({token:t,factory:t.\u0275fac,providedIn:"root"})};var tt=x((t=c(v),e=c(A))=>t.pipe(S(n.getAllRecipes),b(({query:i})=>e.getAllRecipes(i).pipe(F(r=>n.getAllRecipesSuccess({recipeList:r})),T(r=>M(n.getAllRecipesFailure({errors:r?.error?.errors})))))),{functional:!0}),it=x((t=c(v),e=c(A))=>t.pipe(S(n.getRecipeById),b(({recipeId:i})=>e.getRecipeById(i).pipe(F(r=>n.getRecipeByIdSuccess({recipe:r})),T(r=>M(n.getRecipeByIdFailure({errors:r?.error?.error})))))),{functional:!0}),rt=x((t=c(v),e=c(A))=>t.pipe(S(n.deleteRecipeById),b(({recipeId:i})=>e.delete(i).pipe(F(()=>n.deleteRecipeByIdSuccess()),T(r=>M(n.deleteRecipeByIdFailure({errors:r?.error?.error})))))),{functional:!0}),nt=x((t=c(v),e=c(K),i=c(Q))=>t.pipe(S(n.deleteRecipeByIdSuccess),w(()=>{i.showSuccessAlert("recipe","recommended"),e.navigateByUrl("/recipes")})),{functional:!0,dispatch:!1}),ot=x((t=c(v),e=c(A))=>t.pipe(S(n.createRecipe),b(({recipe:i})=>e.create(i).pipe(F(r=>n.createRecipeSuccess({recipe:r})),T(r=>M(n.createRecipeFailure({errors:r?.error?.error})))))),{functional:!0}),ct=x((t=c(v),e=c(K),i=c(Q))=>t.pipe(S(n.createRecipeSuccess),w(()=>{i.showSuccessAlert("recipe","created"),e.navigateByUrl("/recipes")})),{functional:!0,dispatch:!1}),pt=x((t=c(v),e=c(A))=>t.pipe(S(n.updateRecipeById),b(({recipe:i})=>e.update(i).pipe(F(r=>n.updateRecipeByIdSuccess({recipe:r})),T(r=>M(n.updateRecipeByIdFailure({errors:r?.error?.error})))))),{functional:!0}),at=x((t=c(v),e=c(K),i=c(Q))=>t.pipe(S(n.updateRecipeByIdSuccess),w(({recipe:r})=>{i.showSuccessAlert("recipe","updated"),e.navigateByUrl(`/recipes/${r._id}`)})),{functional:!0,dispatch:!1}),st=x((t=c(v),e=c(A))=>t.pipe(S(n.recommendRecipeById),b(({recipeId:i})=>e.recommend(i).pipe(F(r=>n.recommendRecipeByIdSuccess({recipe:r})),T(r=>M(n.recommendRecipeByIdFailure({errors:r?.error?.error})))))),{functional:!0}),lt=x((t=c(v),e=c(Q))=>t.pipe(S(n.recommendRecipeByIdSuccess),w(()=>{e.showSuccessAlert("recipe","recommended")})),{functional:!0,dispatch:!1});export{n as a,_t as b,ht as c,q as d,Ue as e,X as f,Z as g,Ii as h,tt as i,it as j,rt as k,nt as l,ot as m,ct as n,pt as o,at as p,st as q,lt as r,dt as s};
